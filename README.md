# Alchemy Flux

Alchemy-Flux is the Ruby implementation of the [Alchemy Micro-Services Framework](https://github.com/LoyaltyNZ/alchemy-framework). Flux is implemented in Ruby using the [EventMachine](https://github.com/eventmachine/eventmachine) and [AMQP](https://github.com/ruby-amqp/amqp) gems, these work well with the Alchemy style of communication.

### Getting Started

To install Alchemy-Flux:

```
gem install alchemy-flux
```

To create instances of two services, `A` and `B`, and have instance `A1` call service `B`:

```ruby
require 'alchemy-flux'

service_a1 = AlchemyFlux::Service.new("A")

service_b1 = AlchemyFlux::Service.new("B") do |message|
  {'body' => "Hello #{message['body']}"}
end

service_a.start
service_b.start

# Synchronous message
response = service_a1.send_request_to_service("B", {'body' => "Alice"})
puts response['body'] # Hello Alice

# Asynchronous message
service_a1.send_request_to_service("B", {'body' => "Bob"}) do |response|
  puts response['body'] # Hello Bob
end

sleep(1) # wait for asynchronous message to complete

service_a.stop
service_b.stop
```

## Rack Implementation

Alchemy Flux comes with an implementation in Rack so that other popular frameworks like Rails or Sinatra can be used with Alchemy. All you need to do is require the `alchemy-flux` gem into a project and run `rackup -s alchemy` to start the server with Alchemy.

## Documentation

The documentation for Alchemy Flux is generated by [yard](https://rubygems.org/gems/yard/versions/0.8.7.6).

## Examples

Example sending a message:

```
bundle exec ruby examples/example_1_send_message.rb
```

## Contributors

* Graham Jenson
* Tom Cully
